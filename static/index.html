<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azure OpenAI GPT-4o Realtime Audio Chat</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üéôÔ∏è GPT-4o Realtime Audio Chat</h1>
            <p class="subtitle">Powered by Azure OpenAI ‚îÇ Model: gpt-realtime-2025-08-28</p>
        </header>

        <!-- Tech Config Panel -->
        <div class="settings-panel tech-panel">
            <div class="panel-header">
                <h2>‚öôÔ∏è Session Configuration</h2>
                <button id="toggle-advanced-btn" class="btn-small">Show Advanced</button>
            </div>

            <div class="settings-grid">
                <div class="setting-group">
                    <label for="microphone-select">üé§ Input Device</label>
                    <select id="microphone-select" class="tech-select">
                        <option value="">Loading...</option>
                    </select>
                </div>
                <div class="setting-group">
                    <label for="speaker-select">üîä Output Device</label>
                    <select id="speaker-select" class="tech-select">
                        <option value="">Loading...</option>
                    </select>
                </div>
                <div class="setting-group">
                    <label for="voice-select">üó£Ô∏è Voice Model</label>
                    <select id="voice-select" class="tech-select">
                        <option value="">Loading...</option>
                    </select>
                </div>
                <div class="setting-group">
                    <label for="max-tokens-select">üìä Max Tokens</label>
                    <select id="max-tokens-select" class="tech-select">
                        <option value="256">256</option>
                        <option value="512">512</option>
                        <option value="1024">1024</option>
                        <option value="2048">2048</option>
                        <option value="4096" selected>4096</option>
                        <option value="inf">‚àû Unlimited</option>
                    </select>
                </div>
            </div>

            <div class="settings-grid">
                <div class="setting-group slider-group">
                    <label for="temperature-slider">
                        üå°Ô∏è Temperature
                        <code id="temperature-value">0.80</code>
                    </label>
                    <input type="range" id="temperature-slider" min="0.6" max="1.2" step="0.05" value="0.8">
                    <span class="setting-description" id="temperature-description">Creativity level</span>
                </div>
            </div>

            <!-- Advanced Settings (hidden by default) -->
            <div id="advanced-settings" class="advanced-settings hidden">
                <h3>üîß VAD Configuration</h3>
                <div class="settings-grid">
                    <div class="setting-group">
                        <label for="turn-detection-select">Turn Detection</label>
                        <select id="turn-detection-select" class="tech-select">
                            <option value="server_vad">Server VAD</option>
                            <option value="none">Manual (None)</option>
                        </select>
                    </div>
                    <div class="setting-group slider-group">
                        <label for="vad-threshold-slider">
                            VAD Threshold
                            <code id="vad-threshold-value">0.50</code>
                        </label>
                        <input type="range" id="vad-threshold-slider" min="0" max="1" step="0.05" value="0.5">
                    </div>
                    <div class="setting-group slider-group">
                        <label for="vad-prefix-slider">
                            Prefix Padding
                            <code id="vad-prefix-value">300</code>ms
                        </label>
                        <input type="range" id="vad-prefix-slider" min="0" max="1000" step="50" value="300">
                    </div>
                    <div class="setting-group slider-group">
                        <label for="vad-silence-slider">
                            Silence Duration
                            <code id="vad-silence-value">500</code>ms
                        </label>
                        <input type="range" id="vad-silence-slider" min="100" max="2000" step="50" value="500">
                    </div>
                </div>
            </div>
        </div>

        <div class="controls">
            <button id="start-btn" class="btn btn-primary">
                <span class="btn-icon">‚ñ∂Ô∏è</span>
                Start Session
            </button>
            <button id="stop-btn" class="btn btn-danger" disabled>
                <span class="btn-icon">‚èπÔ∏è</span>
                End Session
            </button>
        </div>

        <div class="status-bar">
            <div class="status-indicator" id="connection-status">
                <span class="status-dot disconnected"></span>
                <span class="status-text">Disconnected</span>
            </div>
            <div class="status-indicator" id="speech-status">
                <span class="speech-icon">üé§</span>
                <span class="status-text">Not listening</span>
            </div>
        </div>

        <div class="audio-visualizer" id="audio-visualizer">
            <canvas id="visualizer-canvas"></canvas>
        </div>

        <!-- Main Content: Transcript + Tech Log -->
        <div class="main-content">
            <div class="transcript-container">
                <h2>üí¨ Conversation</h2>
                <div class="transcript" id="transcript">
                    <div class="transcript-placeholder">
                        Start a session to begin the conversation...
                    </div>
                </div>
            </div>

            <div class="techlog-container">
                <div class="techlog-header">
                    <h2>üì° Event Log</h2>
                    <div class="techlog-controls">
                        <div class="filter-group">
                            <label class="filter-checkbox"><input type="checkbox" id="filter-info" checked><span class="filter-label info">info</span></label>
                            <label class="filter-checkbox"><input type="checkbox" id="filter-send" checked><span class="filter-label send">send</span></label>
                            <label class="filter-checkbox"><input type="checkbox" id="filter-receive" checked><span class="filter-label receive">recv</span></label>
                            <label class="filter-checkbox"><input type="checkbox" id="filter-tool" checked><span class="filter-label tool">tool</span></label>
                            <label class="filter-checkbox"><input type="checkbox" id="filter-error" checked><span class="filter-label error">error</span></label>
                        </div>
                        <button id="clear-log-btn" class="btn-small">Clear</button>
                    </div>
                </div>
                <div class="techlog" id="techlog">
                    <div class="log-entry info">[SYS] Waiting for session...</div>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/socket.io.min.js"></script>
    <script src="/static/app.js"></script>
</body>
</html>
